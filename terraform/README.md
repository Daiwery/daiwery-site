## Terraform
Данный файл представляет из себя задокументированные действия и рекомендации автора, связанные с Terraform.

- Установка. Разобраться с сертификатами HashiCorp у автора не получилось. Можно скачать бинарник с официального сайта или с зеркала YandexCloud и сохранить до него путь в alias или в $PATH.

- Инициализация.
```bash
terraform init
# Особенности той среды, в которой работает автор
terraform providers lock -net-mirror=https://terraform-mirror.yandexcloud.net -platform=linux_amd64 yandex-cloud/yandex
terraform init  # На всякий случай 
```

- Для разделение на разные окружения (dev/prod) можно использовать workspace:
```bash
terraform workspace new dev
terraform workspace new prod
```
Это обеспечивает разные файлы состояния для разных окружений.

- Использование разных данных для разных окружений без копирования tf-файлов, а также отсутствия секретов в репозитории, обеспечивает env:
```bash
# .env.dev или любое другое название
export TF_VAR_TOKEN=
export TF_VAR_CLOUD_ID=
export TF_VAR_FOLDER_ID=
...
```
Запуск:
```bash
. .env.dev
```
После чего при запуске terraform необходимые данные будут доступны в variables (см. main.tf).

- Файл состояния terraform.state НЕЛЬЗЯ просто так удалять. Удаление файла грозит потерей знания о текущей инфраструктуре, что влечет за собой полное создание инфрастуктуры с нуля (либо каким-то образом восстановить файл исходя из текущего состояния инфрастуктуры в реальности). Это значит, что необходимо делать бекапы файла состояния, и в случае потери импортировать его в terraform (скопировать в рабочую директорию).

- Крайне не рекомендуется останавливать выполнение terraform, поскольку он не удалит lock, после чего никакие действия не будут доступны.